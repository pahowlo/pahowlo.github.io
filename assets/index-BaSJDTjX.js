!function(){const t=document.createElement("link").relList;if(!(t&&t.supports&&t.supports("modulepreload"))){for(const t of document.querySelectorAll('link[rel="modulepreload"]'))n(t);new MutationObserver(t=>{for(const i of t)if("childList"===i.type)for(const t of i.addedNodes)"LINK"===t.tagName&&"modulepreload"===t.rel&&n(t)}).observe(document,{childList:1,subtree:1})}function n(t){if(t.ep)return;t.ep=1;const n=function(t){const n={};return t.integrity&&(n.integrity=t.integrity),t.referrerPolicy&&(n.referrerPolicy=t.referrerPolicy),"use-credentials"===t.crossOrigin?n.credentials="include":"anonymous"===t.crossOrigin?n.credentials="omit":n.credentials="same-origin",n}(t);fetch(t.href,n)}}();var t=Array.isArray,n=[].indexOf,i=Array.from,r=Object.defineProperty,e=Object.getOwnPropertyDescriptor,s=Object.getOwnPropertyDescriptors,o=Object.prototype,l=Array.prototype,u=Object.getPrototypeOf,h=Object.isExtensible;function f(t){return t()}function a(t){for(var n=0;n<t.length;n++)t[n]()}const c=256,v=1024,d=2048,p=4096,w=8192,y=16384,m=32768,g=1<<19,M=1<<21,b=1<<23,x=Symbol("$state"),_=new class extends Error{name="StaleReactionError";message="The reaction that called `getAbortSignal()` was re-run or destroyed"},S=Symbol();function k(t){return t===this.v}function C(t){return n=t,i=this.v,!(n!=n?i==i:n!==i||null!==n&&"object"==typeof n||"function"==typeof n);var n,i}let E=0,A=null;function T(t){A=t}function j(t,n=0,i){A={p:A,c:null,e:null,s:t,x:null,l:E&&!n?{s:null,u:null,$:[]}:null}}function P(t){var n=A,i=n.e;if(null!==i)for(var r of(n.e=null,i))mt(r);return A=n.p,{}}function R(){return!E||null!==A&&null===A.l}const O=new WeakMap;function D(t,n){for(;null!==n;){if(128&n.f)try{return void n.b.error(t)}catch(i){t=i}n=n.parent}throw t instanceof Error&&F(t),t}function F(t){const n=O.get(t);n&&(r(t,"message",{value:n.message}),r(t,"stack",{value:n.stack}))}let q=[];function z(){var t=q;q=[],a(t)}function B(t){var n=2050,i=null!==Tt&&2&Tt.f?Tt:null;return null===Rt||null!==i&&0!==(i.f&c)?n|=c:Rt.f|=g,{ctx:A,deps:null,effects:null,equals:k,f:n,fn:t,reactions:null,rv:0,v:S,wv:0,parent:i??Rt,ac:null}}function L(t){var n=t.effects;if(null!==n){t.effects=null;for(var i=0;i<n.length;i+=1)xt(n[i])}}function I(t){var n,i=Rt;Ot(function(t){for(var n=t.parent;null!==n;){if(!(2&n.f))return n;n=n.parent}return null}(t));try{L(t),n=Wt(t)}finally{Ot(i)}return n}function $(t){var n=I(t);t.equals(n)||(t.v=n,t.wv=Zt()),Et||(null!==K?K.set(t,t.v):tn(t,!Nt&&0===(t.f&c)||null===t.deps?v:p))}const N=new Set;let Z=null,K=null,H=new Set,W=[];function U(){const t=W.shift();W.length>0&&queueMicrotask(U),t()}let G=[],J=null,Q=0;class V{current=new Map;#t=new Map;#n=new Set;#i=0;#r=null;#e=0;#s=[];#o=[];#l=[];#u=[];#h=[];#f=[];#a=[];skipped_effects=new Set;process(t){G=[];var n=null;if(N.size>1){n=new Map,K=new Map;for(const[t,i]of this.current)n.set(t,{v:t.v,wv:t.wv}),t.v=i;for(const t of N)if(t!==this)for(const[i,r]of t.#t)n.has(i)||(n.set(i,{v:i.v,wv:i.wv}),i.v=r)}for(const e of t)this.#c(e);if(0===this.#s.length&&0===this.#i){this.#v();var i=this.#l,r=this.#u;this.#l=[],this.#u=[],this.#h=[],Z=null,Y(i),Y(r),null===Z?Z=this:N.delete(this),this.#r?.resolve()}else this.#d(this.#l),this.#d(this.#u),this.#d(this.#h);if(n){for(const[t,{v:i,wv:r}]of n)t.wv>r||(t.v=i);K=null}for(const e of this.#s)Jt(e);for(const e of this.#o)Jt(e);this.#s=[],this.#o=[]}#c(t){t.f^=v;for(var n=t.first;null!==n;){var i=n.f,r=!!(96&i);if(!(r&&0!==(i&v)||0!==(i&w)||this.skipped_effects.has(n))&&null!==n.fn){r?n.f^=v:0===(i&v)&&(4&i?this.#u.push(n):4194304&i?(n.b?.pending?this.#o:this.#s).push(n):Kt(n)&&(16&n.f&&this.#h.push(n),Jt(n)));var e=n.first;if(null!==e){n=e;continue}}var s=n.parent;for(n=n.next;null===n&&null!==s;)n=s.next,s=s.parent}}#d(t){for(const n of t)(0!==(n.f&d)?this.#f:this.#a).push(n),tn(n,v);t.length=0}capture(t,n){this.#t.has(t)||this.#t.set(t,n),this.current.set(t,t.v)}activate(){Z=this}deactivate(){Z=null;for(const t of H)if(H.delete(t),t(),null!==Z)break}neuter(){this.#e=1}flush(){G.length>0?function(){var t=kt;Q=1;try{var n=0;for(Ct(1);G.length>0;){var i=V.ensure();n++>1e3&&X(),i.process(G),nt.clear()}}finally{Q=0,Ct(t),J=null}}():this.#v(),Z===this&&(0===this.#i&&N.delete(this),this.deactivate())}#v(){if(!this.#e)for(const t of this.#n)t();this.#n.clear()}increment(){this.#i+=1}decrement(){if(this.#i-=1,0===this.#i){for(const t of this.#f)tn(t,d),tt(t);for(const t of this.#a)tn(t,p),tt(t);this.#l=[],this.#u=[],this.flush()}else this.deactivate()}add_callback(t){this.#n.add(t)}settled(){return(this.#r??={promise:new Promise((i,r)=>{t=i,n=r}),resolve:t,reject:n}).promise;var t,n}static ensure(){if(null===Z){const t=Z=new V;N.add(Z),V.enqueue(()=>{Z===t&&t.flush()})}return Z}static enqueue(t){0===W.length&&queueMicrotask(U),W.unshift(t)}}function X(){try{!function(){throw Error("https://svelte.dev/e/effect_update_depth_exceeded")}()}catch(t){D(t,J)}}function Y(t){var n=t.length;if(0!==n){for(var i=0;n>i;){var r=t[i++];if(!(24576&r.f)&&Kt(r)){var e=Z?Z.current.size:0;if(Jt(r),null===r.deps&&null===r.first&&null===r.nodes_start&&(null===r.teardown&&null===r.ac?_t(r):r.fn=null),null!==Z&&Z.current.size>e&&1048576&r.f)break}}for(;n>i;)tt(t[i++])}}function tt(t){for(var n=J=t;null!==n.parent;){var i=(n=n.parent).f;if(Q&&n===Rt&&16&i)return;if(96&i){if(0===(i&v))return;n.f^=v}}G.push(n)}const nt=new Map;function it(t,n){return{f:0,v:t,reactions:null,equals:k,rv:0,wv:0}}function rt(t,n){const i=it(t);var r;return r=i,null!==Tt&&(null===Dt?Dt=[r]:Dt.push(r)),i}function et(t,n=0,i=1){const r=it(t);return n||(r.equals=C),E&&i&&null!==A&&null!==A.l&&(A.l.s??=[]).push(r),r}function st(t,n,i=0){return null!==Tt&&(!jt||!!(131072&Tt.f))&&R()&&4325394&Tt.f&&!Dt?.includes(t)&&function(){throw Error("https://svelte.dev/e/state_unsafe_mutation")}(),function(t,n){if(!t.equals(n)){var i=t.v;Et?nt.set(t,n):nt.set(t,i),t.v=n,V.ensure().capture(t,i),2&t.f&&(0!==(t.f&d)&&I(t),tn(t,0===(t.f&c)?v:p)),t.wv=Zt(),lt(t,d),!R()||null===Rt||0===(Rt.f&v)||96&Rt.f||(null===zt?function(t){zt=t}([t]):zt.push(t))}return n}(t,i?ut(n):n)}function ot(t){st(t,t.v+1)}function lt(t,n){var i=t.reactions;if(null!==i)for(var r=R(),e=i.length,s=0;e>s;s++){var o=i[s],l=o.f;if(r||o!==Rt){var u=0===(l&d);u&&tn(o,n),2&l?lt(o,p):u&&tt(o)}}}function ut(n){if("object"!=typeof n||null===n||x in n)return n;const i=u(n);if(i!==o&&i!==l)return n;var r=new Map,s=t(n),h=rt(0),f=It,a=t=>{if(It===f)return t();var n=Tt,i=It;Pt(null),$t(f);var r=t();return Pt(n),$t(i),r};return s&&r.set("length",rt(n.length)),new Proxy(n,{defineProperty(t,n,i){"value"in i&&0!=i.configurable&&0!=i.enumerable&&0!=i.writable||function(){throw Error("https://svelte.dev/e/state_descriptors_fixed")}();var e=r.get(n);return void 0===e?e=a(()=>{var t=rt(i.value);return r.set(n,t),t}):st(e,i.value,1),1},deleteProperty(t,n){var i=r.get(n);if(void 0===i){if(n in t){const t=a(()=>rt(S));r.set(n,t),ot(h)}}else st(i,S),ot(h);return 1},get(t,i,s){if(i===x)return n;var o=r.get(i),l=i in t;if(void 0!==o||l&&!e(t,i)?.writable||(o=a(()=>rt(ut(l?t[i]:S))),r.set(i,o)),void 0!==o){var u=Qt(o);return u===S?void 0:u}return Reflect.get(t,i,s)},getOwnPropertyDescriptor(t,n){var i=Reflect.getOwnPropertyDescriptor(t,n);if(i&&"value"in i){var e=r.get(n);e&&(i.value=Qt(e))}else if(void 0===i){var s=r.get(n),o=s?.v;if(void 0!==s&&o!==S)return{enumerable:1,configurable:1,value:o,writable:1}}return i},has(t,n){if(n===x)return 1;var i=r.get(n),s=void 0!==i&&i.v!==S||Reflect.has(t,n);return void 0===i&&(null===Rt||s&&!e(t,n)?.writable)||(void 0===i&&(i=a(()=>rt(s?ut(t[n]):S)),r.set(n,i)),Qt(i)!==S)?s:0},set(t,n,i,o){var l=r.get(n),u=n in t;if(s&&"length"===n)for(var f=i;f<l.v;f+=1){var c=r.get(f+"");void 0!==c?st(c,S):f in t&&(c=a(()=>rt(S)),r.set(f+"",c))}void 0===l?u&&!e(t,n)?.writable||(st(l=a(()=>rt(void 0)),ut(i)),r.set(n,l)):(u=l.v!==S,st(l,a(()=>ut(i))));var v=Reflect.getOwnPropertyDescriptor(t,n);if(v?.set&&v.set.call(o,i),!u){if(s&&"string"==typeof n){var d=r.get("length"),p=+n;Number.isInteger(p)&&p>=d.v&&st(d,p+1)}ot(h)}return 1},ownKeys(t){Qt(h);var n=Reflect.ownKeys(t).filter(t=>{var n=r.get(t);return void 0===n||n.v!==S});for(var[i,e]of r)e.v===S||i in t||n.push(i);return n},setPrototypeOf(){!function(){throw Error("https://svelte.dev/e/state_prototype_fixed")}()}})}var ht,ft,at,ct;function vt(t){return at.call(t)}function dt(t){return ct.call(t)}function pt(t){null===Rt&&null===Tt&&function(){throw Error("https://svelte.dev/e/effect_orphan")}(),null!==Tt&&0!==(Tt.f&c)&&null===Rt&&function(){throw Error("https://svelte.dev/e/effect_in_unowned_derived")}(),Et&&function(){throw Error("https://svelte.dev/e/effect_in_teardown")}()}function wt(t,n,i,r=1){var e=Rt;null!==e&&0!==(e.f&w)&&(t|=w);var s={ctx:A,deps:null,nodes_start:null,nodes_end:null,f:t|d,first:null,fn:n,last:null,next:null,parent:e,b:e&&e.b,prev:null,teardown:null,transitions:null,wv:0,ac:null};if(i)try{Jt(s),s.f|=m}catch(l){throw xt(s),l}else null!==n&&tt(s);if((!i||null!==s.deps||null!==s.first||null!==s.nodes_start||null!==s.teardown||0!==(s.f&g))&&r&&(null!==e&&function(t,n){var i=n.last;null===i?n.last=n.first=t:(i.next=t,t.prev=i,n.last=t)}(s,e),null!==Tt&&2&Tt.f&&!(64&t))){var o=Tt;(o.effects??=[]).push(s)}return s}function yt(t){pt();var n=Rt.f;if(Tt||!(32&n)||0!==(n&m))return mt(t);var i=A;(i.e??=[]).push(t)}function mt(t){return wt(1048580,t,0)}function gt(t){V.ensure();const n=wt(64,t,1);return(t={})=>new Promise(i=>{t.outro?function(t,n){var i=[];St(t,i,1),function(t,n){var i=t.length;if(i>0){var r=()=>--i||n();for(var e of t)e.out(r)}else n()}(i,()=>{xt(t),n&&n()})}(n,()=>{xt(n),i(void 0)}):(xt(n),i(void 0))})}function Mt(t){var n=t.teardown;if(null!==n){const t=Et,i=Tt;At(1),Pt(null);try{n.call(null)}finally{At(t),Pt(i)}}}function bt(t,n=0){var i=t.first;for(t.first=t.last=null;null!==i;){i.ac?.abort(_);var r=i.next;64&i.f?i.parent=null:xt(i,n),i=r}}function xt(t,n=1){var i=0;(n||262144&t.f)&&null!==t.nodes_start&&null!==t.nodes_end&&(function(t,n){for(;null!==t;){var i=t===n?null:dt(t);t.remove(),t=i}}(t.nodes_start,t.nodes_end),i=1),bt(t,n&&!i),Gt(t,0),tn(t,y);var r=t.transitions;if(null!==r)for(const s of r)s.stop();Mt(t);var e=t.parent;null!==e&&null!==e.first&&_t(t),t.next=t.prev=t.teardown=t.ctx=t.deps=t.fn=t.nodes_start=t.nodes_end=t.ac=null}function _t(t){var n=t.parent,i=t.prev,r=t.next;null!==i&&(i.next=r),null!==r&&(r.prev=i),null!==n&&(n.first===t&&(n.first=r),n.last===t&&(n.last=i))}function St(t,n,i){if(0===(t.f&w)){if(t.f^=w,null!==t.transitions)for(const r of t.transitions)(r.is_global||i)&&n.push(r);for(var r=t.first;null!==r;){var e=r.next;St(r,n,65536&r.f||32&r.f?i:0),r=e}}}let kt=0;function Ct(t){kt=t}let Et=0;function At(t){Et=t}let Tt=null,jt=0;function Pt(t){Tt=t}let Rt=null;function Ot(t){Rt=t}let Dt=null,Ft=null,qt=0,zt=null,Bt=1,Lt=0,It=Lt;function $t(t){It=t}let Nt=0;function Zt(){return++Bt}function Kt(t){var n=t.f;if(0!==(n&d))return 1;if(0!==(n&p)){var i=t.deps,r=0!==(n&c);if(null!==i){var e,s,o=!!(512&n),l=r&&null!==Rt&&!Nt,u=i.length;if((o||l)&&(null===Rt||0===(Rt.f&y))){var h=t,f=h.parent;for(e=0;u>e;e++)s=i[e],!o&&s?.reactions?.includes(h)||(s.reactions??=[]).push(h);o&&(h.f^=512),l&&null!==f&&0===(f.f&c)&&(h.f^=c)}for(e=0;u>e;e++)if(Kt(s=i[e])&&$(s),s.wv>t.wv)return 1}r&&(null===Rt||Nt)||tn(t,v)}return 0}function Ht(t,n,i=1){var r=t.reactions;if(null!==r&&!Dt?.includes(t))for(var e=0;e<r.length;e++){var s=r[e];2&s.f?Ht(s,n,0):n===s&&(i?tn(s,d):0!==(s.f&v)&&tn(s,p),tt(s))}}function Wt(t){var n=Ft,i=qt,r=zt,e=Tt,s=Nt,o=Dt,l=A,u=jt,h=It,f=t.f;Ft=null,qt=0,zt=null,Nt=0!==(f&c)&&(jt||!kt||null===Tt),Tt=96&f?null:t,Dt=null,T(t.ctx),jt=0,It=++Lt,null!==t.ac&&(t.ac.abort(_),t.ac=null);try{t.f|=M;var a=(0,t.fn)(),v=t.deps;if(null!==Ft){var d;if(Gt(t,qt),null!==v&&qt>0)for(v.length=qt+Ft.length,d=0;d<Ft.length;d++)v[qt+d]=Ft[d];else t.deps=v=Ft;if(!Nt||2&f&&null!==t.reactions)for(d=qt;d<v.length;d++)(v[d].reactions??=[]).push(t)}else null!==v&&qt<v.length&&(Gt(t,qt),v.length=qt);if(R()&&null!==zt&&!jt&&null!==v&&!(6146&t.f))for(d=0;d<zt.length;d++)Ht(zt[d],t);return null!==e&&e!==t&&(Lt++,null!==zt&&(null===r?r=zt:r.push(...zt))),0!==(t.f&b)&&(t.f^=b),a}catch(p){return function(t){var n=Rt;if(null===n)return Tt.f|=b,t;if(0===(n.f&m)){if(!(128&n.f))throw!n.parent&&t instanceof Error&&F(t),t;n.b.error(t)}else D(t,n)}(p)}finally{t.f^=M,Ft=n,qt=i,zt=r,Tt=e,Nt=s,Dt=o,T(l),jt=u,It=h}}function Ut(t,i){let r=i.reactions;if(null!==r){var e=n.call(r,t);if(-1!==e){var s=r.length-1;0===s?r=i.reactions=null:(r[e]=r[s],r.pop())}}null===r&&2&i.f&&(null===Ft||!Ft.includes(i))&&(tn(i,p),768&i.f||(i.f^=512),L(i),Gt(i,0))}function Gt(t,n){var i=t.deps;if(null!==i)for(var r=n;r<i.length;r++)Ut(t,i[r])}function Jt(t){var n=t.f;if(0===(n&y)){tn(t,v);var i=Rt,r=kt;Rt=t,kt=1;try{16&n?function(t){for(var n=t.first;null!==n;){var i=n.next;!(32&n.f)&&xt(n),n=i}}(t):bt(t),Mt(t);var e=Wt(t);t.teardown="function"==typeof e?e:null,t.wv=Bt}finally{kt=r,Rt=i}}}function Qt(t){var n=!!(2&t.f);if(null===Tt||jt){if(n&&null===t.deps&&null===t.effects){var i=t,r=i.parent;null!==r&&0===(r.f&c)&&(i.f^=c)}}else if((null===Rt||0===(Rt.f&y))&&!Dt?.includes(t)){var e=Tt.deps;if(0!==(Tt.f&M))t.rv<Lt&&(t.rv=Lt,null===Ft&&null!==e&&e[qt]===t?qt++:null===Ft?Ft=[t]:Nt&&Ft.includes(t)||Ft.push(t));else{(Tt.deps??=[]).push(t);var s=t.reactions;null===s?t.reactions=[Tt]:s.includes(Tt)||s.push(Tt)}}if(Et){if(nt.has(t))return nt.get(t);if(n){var o=(i=t).v;return(0===(i.f&v)&&null!==i.reactions||Vt(i))&&(o=I(i)),nt.set(i,o),o}}else if(n){if(i=t,K?.has(i))return K.get(i);Kt(i)&&$(i)}if(0!==(t.f&b))throw t.v;return t.v}function Vt(t){if(t.v===S)return 1;if(null===t.deps)return 0;for(const n of t.deps){if(nt.has(n))return 1;if(2&n.f&&Vt(n))return 1}return 0}function Xt(t){var n=jt;try{return jt=1,t()}finally{jt=n}}const Yt=-7169;function tn(t,n){t.f=t.f&Yt|n}function nn(t,n=new Set){if(!("object"!=typeof t||null===t||t instanceof EventTarget||n.has(t))){n.add(t),t instanceof Date&&t.getTime();for(let e in t)try{nn(t[e],n)}catch(i){}const r=u(t);if(r!==Object.prototype&&r!==Array.prototype&&r!==Map.prototype&&r!==Set.prototype&&r!==Date.prototype){const n=s(r);for(let r in n){const e=n[r].get;if(e)try{e.call(t)}catch(i){}}}}}const rn=["touchstart","touchmove"];function en(t){return rn.includes(t)}const sn=new Set,on=new Set;function ln(n){var i=this,e=i.ownerDocument,s=n.type,o=n.composedPath?.()||[],l=o[0]||n.target,u=0,h=n.t;if(h){var f=o.indexOf(h);if(-1!==f&&(i===document||i===window))return void(n.t=i);var a=o.indexOf(i);if(-1===a)return;f>a||(u=f)}if((l=o[u]||n.target)!==i){r(n,"currentTarget",{configurable:1,get:()=>l||e});var c=Tt,v=Rt;Pt(null),Ot(null);try{for(var d,p=[];null!==l;){var w=l.assignedSlot||l.parentNode||l.host||null;try{var y=l["__"+s];if(null!=y&&(!l.disabled||n.target===l))if(t(y)){var[m,...g]=y;m.call(l,n,...g)}else y.call(l,n)}catch(M){d?p.push(M):d=M}if(n.cancelBubble||w===i||null===w)break;l=w}if(d){for(let t of p)queueMicrotask(()=>{throw t});throw d}}finally{n.t=i,delete n.currentTarget,Pt(c),Ot(v)}}}function un(t,n){var i,r=!!(2&n),e=!t.startsWith("<!>");return()=>{var n,s;void 0===i&&(n=e?t:"<!>"+t,(s=document.createElement("template")).innerHTML=n.replaceAll("<!>","\x3c!----\x3e"),i=vt(i=s.content));var o,l,u,h=r||ft?document.importNode(i,1):i.cloneNode(1);return o=h,l=h,null===(u=Rt).nodes_start&&(u.nodes_start=o,u.nodes_end=l),h}}const hn=new Map;let fn=new WeakMap;function an(t,n){return t===n||t?.[x]===n}function cn(t,n){if(t.l.s)for(const i of t.l.s)Qt(i);n()}"undefined"!=typeof window&&((window.__svelte??={}).v??=new Set).add("5"),E=1;var vn="undefined"!=typeof Float32Array?Float32Array:Array;function dn(){var t=new vn(3);return vn!=Float32Array&&(t[0]=0,t[1]=0,t[2]=0),t}function pn(t){var n=t[0],i=t[1],r=t[2];return Math.hypot(n,i,r)}function wn(t,n,i){var r=new vn(3);return r[0]=t,r[1]=n,r[2]=i,r}function yn(t,n,i){return t[0]=n[0]+i[0],t[1]=n[1]+i[1],t[2]=n[2]+i[2],t}function mn(t,n,i){return t[0]=n[0]-i[0],t[1]=n[1]-i[1],t[2]=n[2]-i[2],t}function gn(t,n,i){return t[0]=n[0]*i,t[1]=n[1]*i,t[2]=n[2]*i,t}function Mn(t,n,i,r){return t[0]=n[0]+i[0]*r,t[1]=n[1]+i[1]*r,t[2]=n[2]+i[2]*r,t}function bn(t,n){var i=n[0],r=n[1],e=n[2],s=i*i+r*r+e*e;return s>0&&(s=1/Math.sqrt(s)),t[0]=n[0]*s,t[1]=n[1]*s,t[2]=n[2]*s,t}Math.hypot||(Math.hypot=function(){for(var t=0,n=arguments.length;n--;)t+=arguments[n]*arguments[n];return Math.sqrt(t)}),dn();class xn{canvas;positionOnCanvas;isPressed=0;isFocused=1;constructor(t){this.canvas=t,this.canvas.tabIndex=0,this.setupEventListeners(this.canvas)}isMousePressed(){return this.isPressed}isMouseFocused(){return this.isFocused}setupEventListeners(t){t.addEventListener("mouseenter",()=>{}),t.addEventListener("focus",()=>{this.isFocused=1}),t.addEventListener("blur",()=>{this.isFocused=0,this.isPressed=0,this.positionOnCanvas=void 0}),t.addEventListener("mouseleave",()=>{this.isFocused=0,this.isPressed=0,this.positionOnCanvas=void 0}),t.addEventListener("mousemove",t=>{const n=wn(t.clientX,t.clientY,50);this.positionOnCanvas=n}),t.addEventListener("mousedown",()=>{this.isPressed=1}),t.addEventListener("mouseup",()=>{this.isPressed=0})}}class _n{start;end;width;height;constructor(t,n,i,r){this.start={x:t,y:n},this.end={x:t+i,y:n+r},this.width=i,this.height=r}equals(t){return this.start.x===t.start.x&&this.start.y===t.start.y&&this.width===t.width&&this.height===t.height}}class Sn{canvasBox;maxDepth;polygon;centroids;constructor(t,n,i=.1){this.canvasBox=t,this.maxDepth=n;const r=n/2,e=Math.min(t.width*i,t.height*i);this.polygon=[wn(t.start.x+e,t.start.y+e,r),wn(t.end.x-e,t.start.y+e,r),wn(t.end.x-e,t.end.y-e,r),wn(t.start.x+e,t.end.y-e,r)],this.centroids=[]}addCentroid(t){const n=(i=t,(r=new vn(3))[0]=i[0],r[1]=i[1],r[2]=i[2],r);var i,r;n[0]+=this.canvasBox.start.x,n[1]+=this.canvasBox.start.y,n[2]=Math.max(0,Math.min(this.maxDepth,n[2])),this.centroids.push(n)}clearCentroids(){this.centroids.length=0}isOutside(t){const n=t[2];return n>this.maxDepth||0>n||!function(t,n){if(3>n.length)return 0;let i=0;const r=t[0],e=t[1];for(let s=0,o=n.length-1;s<n.length;o=s++){const t=n[s][0],l=n[s][1],u=n[o][0],h=n[o][1];e>=l==h>e&&(u-t)*(e-l)/(h-l)+t>r&&(i=!i)}return i}(t,this.polygon)}resize(t){if(this.canvasBox.equals(t))return;const n=t.width===this.canvasBox.width?1:t.width/this.canvasBox.width,i=t.height===this.canvasBox.height?1:t.height/this.canvasBox.height;for(const r of this.polygon)r[0]=(r[0]-this.canvasBox.start.x)*n+t.start.x,r[1]=(r[1]-this.canvasBox.start.y)*i+t.start.y;for(const r of this.centroids)r[0]=(r[0]-this.canvasBox.start.x)*n+t.start.x,r[1]=(r[1]-this.canvasBox.start.y)*i+t.start.y;this.canvasBox=t}}const kn={clearCanvasIfResized:1,boids:{lineWidth:.1,size:3},debug:{flightZone:{polygonColor:"#00ff00",centroidsColor:"#0000ff"}}};class Cn{window;canvas;renderingContext;config;screenBox;canvasBox;maxHeight;devicePixelRatio;screenHasTopLeft=0;boidPath=function(){const t=new Path2D;return t.moveTo(-.5,.3),t.lineTo(1,0),t.lineTo(-.5,-.3),t.moveTo(-.5,.3),t.lineTo(-.5,-.3),t.moveTo(1,0),t.lineTo(-.5,0),t}();constructor(t,n,i={}){this.window=t,this.canvas=n;const r=n.getContext("2d");if(!r)throw Error("Canvas context not available");this.renderingContext=r,this.config={...kn,...i},this.screenBox=this.getScreenBox(),this.canvasBox=this.getCanvasBox(),this.devicePixelRatio=this.window.devicePixelRatio||1,this.maxHeight=this.getMaxHeight(),this.scaleCanvas()}getMaxHeight(){return this.screenHasTopLeft?this.screenBox.end.y-20:Math.max(this.canvasBox.end.y,this.screenBox.end.y)-20}checkResize(){this.screenBox=this.getScreenBox();const t=this.window.devicePixelRatio||1,n=this.getCanvasBox();return this.canvasBox.equals(n)&&this.devicePixelRatio===t?0:(this.config.clearCanvasIfResized&&this.clearCanvas(),this.devicePixelRatio=t,this.canvasBox=n,this.maxHeight=this.getMaxHeight(),this.scaleCanvas(),1)}getScreenBox(){let t=0,n=0;return"left"in this.window.screen&&"top"in this.window.screen&&"number"==typeof this.window.screen.left&&"number"==typeof this.window.screen.top?(this.screenHasTopLeft=1,t=this.window.screen.left,n=this.window.screen.top):this.screenHasTopLeft=0,new _n(t,n,this.window.screen.width,this.window.screen.height)}getCanvasBox(){const t=this.canvas.getBoundingClientRect();return new _n(this.window.screenX+(this.window.outerWidth-this.window.innerWidth)+t.left,this.window.screenY+(this.window.outerHeight-this.window.innerHeight)+t.top,t.width,t.height)}scaleCanvas(){const t=this.renderingContext,n=this.canvas.clientWidth,i=this.canvas.clientHeight;this.canvas.width=n*this.devicePixelRatio,this.canvas.height=i*this.devicePixelRatio,t.scale(this.devicePixelRatio,this.devicePixelRatio)}clearCanvas(){const t=this.renderingContext;t.canvas.width=t.canvas.width,t.scale(this.devicePixelRatio,this.devicePixelRatio)}drawFlightZone(t){const n=this.canvasBox.start.x,i=this.canvasBox.start.y,r=this.renderingContext;r.save(),r.strokeStyle=this.config.debug.flightZone.polygonColor,r.lineWidth=1,r.beginPath(),r.moveTo(t.polygon[0][0]-n,t.polygon[0][1]-i);for(let e=1;e<t.polygon.length;e++)r.lineTo(t.polygon[e][0]-n,t.polygon[e][1]-i);r.closePath(),r.stroke(),r.beginPath(),r.strokeStyle=this.config.debug.flightZone.centroidsColor;for(const e of t.centroids){const t=e[0]-n,s=e[1]-i,o=10;r.arc(t,s,o,0,2*Math.PI),r.moveTo(t-o,s),r.lineTo(t+o,s),r.moveTo(t,s-o),r.lineTo(t,s+o)}r.stroke(),r.restore()}drawBoid(t,n){const i=t.position,r=t.velocity,e=this.canvasBox.start.x,s=this.canvasBox.start.y,o=Math.min(1.125,Math.max(-.125,i[2]/n));let l=this.config.boids.size;0>o?l+=8*-o:o>1&&(l-=8*(o-1));const u=this.renderingContext;u.save(),u.translate(i[0]-e,i[1]-s),u.rotate(Math.atan2(r[1],r[0])),u.scale(l,l),u.strokeStyle=`hsl(10, 10%, ${Math.max(10,90-80*o)}%)`,u.lineWidth=this.config.boids.lineWidth,u.stroke(this.boidPath),u.restore()}}function En(t,n){if(n>=t.length)return t.slice();const i=[];for(let r=0;n>r;r++)i[r]=t[r];for(let r=n;r<t.length;r++){const e=Math.floor(Math.random()*(r+1));n>e&&(i[e]=t[r])}return i}class An{cellSize;cellRadius;grid;prevCellKeys=new Map;constructor(t){this.cellSize=wn(t.x,t.y,0),this.cellRadius=Math.ceil(Math.sqrt((t.x*t.x+t.y*t.y)/2)),this.grid=new Map}getCellKey(t){return`${Math.floor(t[0]/this.cellSize[0])},${Math.floor(t[1]/this.cellSize[1])}`}update(t){const n=t.position,i=this.getCellKey(n),r=this.prevCellKeys.get(t);if(r===i)return;if(r){const n=this.grid.get(r);if(n){const i=n.indexOf(t);-1!==i&&(1==n.length?this.grid.delete(r):(n[i]=n[n.length-1],n.pop()))}}const e=this.grid.get(i);e?e.push(t):this.grid.set(i,[t]),this.prevCellKeys.set(t,i)}getNeighbors(t,n){const i=this.getCellKey(t.position),r=n.limitCount??1e3,e=[];let s=0,o=Math.max(0,n.min);if(0==o){const n=this.grid.get(i);if(n)for(const i of n)if(i!==t&&(e.push(i),s++,s>=r))return e;o++}const[l,u]=i.split(",").map(Number);for(let h=o;h<=n.max;h++){const t=[];for(const{dx:n,dy:i}of this.diamondSpiralIterator(h)){const r=this.grid.get(`${l+n},${u+i}`);r&&t.push(...r)}if(s+t.length>=r){const n=r-s;return e.push(...En(t,n)),e}e.push(...t),s+=t.length}return e}*diamondSpiralIterator(t){let n=t,i=0;for(yield{dx:n,dy:i};n>0;)n--,i++,yield{dx:n,dy:i};for(;n>-t;)n--,i--,yield{dx:n,dy:i};for(;0>n;)n++,i--,yield{dx:n,dy:i};for(;t>n;)n++,i++,yield{dx:n,dy:i}}}const Tn={minSpeed:1,maxSpeed:6,maxTurnAngleDeg:120,acceleration:{backToFlightZone:.6,followCentroids:.6,pullUpTerrain:1.8,cohesion:.6,alignment:1,separation:1.2,gravity:.05}};class jn{displayId;position;velocity;acceleration;config;backToFlightZone;followCentroids;constructor(t,n,i={}){this.displayId=t,this.config={...i,...Tn};const r=2*Math.random()*Math.PI;this.position=n,this.velocity=wn(Math.cos(r)*this.config.maxSpeed,Math.sin(r)*this.config.maxSpeed,0),this.acceleration=dn()}update(t,n,i,r,e,s,o){let l=this.config.maxTurnAngleDeg,u=this.config.maxSpeed;const h=dn();if(this.position[1]<o||(h[1]=-this.config.acceleration.pullUpTerrain,l+=20,u+=1),!this.backToFlightZone&&r(this.position)){const t=dn();for(const n of e)yn(t,t,mn(dn(),n,this.position));bn(t,t),this.backToFlightZone={direction:t,remainingTicks:30}}if(this.backToFlightZone&&(Mn(h,h,this.backToFlightZone.direction,this.config.acceleration.backToFlightZone),this.backToFlightZone.remainingTicks--,this.backToFlightZone.remainingTicks>0||(this.backToFlightZone=void 0)),!this.followCentroids&&s){const t=dn();for(const n of s){const i=mn(dn(),n,this.position),r=Math.abs(i[0])+Math.abs(i[1]),e=500-r;e>0&&(gn(i,i,e/r),yn(t,t,i))}bn(t,t),this.followCentroids={direction:t,remainingTicks:5}}this.followCentroids&&(Mn(h,h,this.followCentroids.direction,this.config.acceleration.followCentroids),this.followCentroids.remainingTicks--,this.followCentroids.remainingTicks>0||(this.followCentroids=void 0)),yn(h,h,this.cohesionAcceleration(t)),yn(h,h,this.alignmentAcceleration(t)),yn(h,h,this.separationAcceleration(n,i)),function(t,n,i,r){const e=bn(dn(),n),s=bn(dn(),i),o=r*Math.PI/180,l=(h=s,f=(u=e)[0],a=u[1],c=u[2],v=h[0],d=h[1],p=h[2],y=(w=Math.sqrt(f*f+a*a+c*c)*Math.sqrt(v*v+d*d+p*p))&&function(t,n){return t[0]*n[0]+t[1]*n[1]+t[2]*n[2]}(u,h)/w,Math.acos(Math.min(Math.max(y,-1),1)));var u,h,f,a,c,v,d,p,w,y;l>o?(function(t,n,i,r){var e=n[0],s=n[1],o=n[2];t[0]=e+r*(i[0]-e),t[1]=s+r*(i[1]-s),t[2]=o+r*(i[2]-o)}(t,e,s,(o+20)/l),bn(t,t),gn(t,t,pn(i))):function(t,n){t[0]=n[0],t[1]=n[1],t[2]=n[2]}(t,i)}(this.acceleration,this.velocity,h,l),this.acceleration[1]+=this.config.acceleration.gravity,yn(this.velocity,this.velocity,this.acceleration),pn(this.velocity)>u?(bn(this.velocity,this.velocity),gn(this.velocity,this.velocity,u)):pn(this.velocity)<this.config.minSpeed&&(bn(this.velocity,this.velocity),gn(this.velocity,this.velocity,this.config.minSpeed)),this.position=yn(this.position,this.position,this.velocity)}alignmentAcceleration(t){const n=dn();for(const i of t)yn(n,n,i.velocity);return bn(n,n),gn(n,n,this.config.acceleration.alignment),n}cohesionAcceleration(t){const n=dn();for(const i of t)yn(n,n,mn(dn(),i.position,this.position));return bn(n,n),gn(n,n,this.config.acceleration.cohesion),n}separationAcceleration(t,n){const i=dn();for(const r of t){const t=mn(dn(),this.position,r.position),e=pn(t);0!==e&&(gn(t,t,n/e),yn(i,i,t))}return bn(i,i),gn(i,i,this.config.acceleration.separation),i}}const Pn={maxDepth:250,grid:{cellSize:{x:10,y:10},neighborDistance:{min:1,max:5,limitCount:30},closeNeighborDistance:{min:0,max:0,limitCount:20}}};class Rn{simBox;config;maxBoidCount=0;boidConfig={};boids=[];spatialGrid;isRunning=0;nextDisplayId=0;constructor(t,n={}){this.simBox=t,this.config={...Pn,...n},this.spatialGrid=new An(this.config.grid.cellSize)}maxDepth(){return this.config.maxDepth}resize(t,n){this.simBox=t,n&&(this.config.maxDepth=n)}start(t,n){this.maxBoidCount=t,this.boidConfig=n;for(let i=0;i<this.maxBoidCount;i++){const t=wn(this.simBox.start.x+this.simBox.width*(1.4*Math.random()-.2),this.simBox.start.y+this.simBox.height*(1.2*Math.random()-.2)-20,Math.random()*this.config.maxDepth),n=new jn(this.nextDisplayId,t,this.boidConfig);this.nextDisplayId++,this.boids.push(n),this.spatialGrid.update(n)}this.isRunning=1}update(t,n){if(this.isRunning)for(const i of this.boids){const r=this.spatialGrid.getNeighbors(i,this.config.grid.neighborDistance),e=this.spatialGrid.getNeighbors(i,this.config.grid.closeNeighborDistance);i.update(r,e,this.spatialGrid.cellRadius,n=>t.isOutside(n),t.polygon,t.centroids,n),this.spatialGrid.update(i)}}stop(){this.isRunning=0,this.boids=[],this.maxBoidCount=0}}class On{renderer;flightZone;simulation;inputs;debug=0;isRunning=0;animationId=null;resizeTimeoutId=null;constructor(t,n,i={}){this.renderer=new Cn(t,n,i),this.simulation=new Rn(this.renderer.screenBox),this.flightZone=new Sn(this.renderer.canvasBox,this.simulation.maxDepth()),this.inputs={mouse:new xn(n)}}start(t,n,i={}){this.debug=n,this.simulation.maxBoidCount=t,this.simulation.boidConfig=i,this.isRunning||(this.isRunning=1,this.simulation.start(t,i),this.animationLoop(),this.resizeLoop())}animationLoop=()=>{if(!this.isRunning)return;this.flightZone.clearCentroids(),this.inputs.mouse.isMouseFocused()&&this.inputs.mouse.positionOnCanvas&&this.flightZone.addCentroid(this.inputs.mouse.positionOnCanvas);const t=this.renderer.maxHeight;this.simulation.update(this.flightZone,t),this.renderer.clearCanvas(),this.debug&&this.renderer.drawFlightZone(this.flightZone),this.simulation.boids.forEach(t=>{this.renderer.drawBoid(t,this.simulation.maxDepth())}),this.animationId=requestAnimationFrame(this.animationLoop)};resizeLoop=()=>{this.isRunning&&(this.renderer.checkResize()&&(this.flightZone.resize(this.renderer.canvasBox),this.simulation.resize(this.renderer.screenBox)),this.resizeTimeoutId=setTimeout(this.resizeLoop,10))};stop(){this.animationId&&(cancelAnimationFrame(this.animationId),this.animationId=null),this.resizeTimeoutId&&(clearTimeout(this.resizeTimeoutId),this.resizeTimeoutId=null),this.renderer.clearCanvas(),this.simulation.stop(),this.isRunning=0}}var Dn=un('<main class="svelte-uxr442"><canvas class="svelte-uxr442"></canvas></main>');!function(t,{target:n,anchor:r,props:s={},events:o,context:l,intro:u=1}){!function(){if(void 0===ht){ht=window,ft=/Firefox/.test(navigator.userAgent);var t=Element.prototype,n=Node.prototype,i=Text.prototype;at=e(n,"firstChild").get,ct=e(n,"nextSibling").get,h(t)&&(t.i=void 0,t.o=void 0,t.h=null,t.M=void 0,t._=void 0),h(i)&&(i.S=void 0)}}();var f=new Set,a=t=>{for(var i=0;i<t.length;i++){var r=t[i];if(!f.has(r)){f.add(r);var e=en(r);n.addEventListener(r,ln,{passive:e});var s=hn.get(r);void 0===s?(document.addEventListener(r,ln,{passive:e}),hn.set(r,1)):hn.set(r,s+1)}}};a(i(sn)),on.add(a);var c=void 0,v=gt(()=>{var i=r??n.appendChild(function(t=""){return document.createTextNode(t)}());return function(t,n=1){wt(32,t,1,n)}(()=>{l&&(j({}),A.c=l),o&&(s.$$events=o),c=t(i,s)||{},l&&P()}),()=>{for(var t of f){n.removeEventListener(t,ln);var e=hn.get(t);0===--e?(document.removeEventListener(t,ln),hn.delete(t)):hn.set(t,e)}on.delete(a),i!==r&&i.parentNode?.removeChild(i)}});fn.set(c,v)}(function(t,n){let i;j(n,0);let r=et(null),e=0;var s,o,l;s=()=>{i=new URLSearchParams(window.location.search),i.has("debug")&&(e=1),Qt(r)&&new On(window,Qt(r)).start(5200,e,{})},null===A&&function(){throw Error("https://svelte.dev/e/lifecycle_outside_component")}(),E&&null!==A.l?(o=A,l=o.l,l.u??={a:[],b:[],m:[]}).m.push(s):yt(()=>{const t=Xt(s);if("function"==typeof t)return t}),function(t=0){const n=A,i=n.l.u;if(!i)return;let r=()=>function(t){if("object"==typeof t&&t&&!(t instanceof EventTarget))if(x in t)nn(t);else if(!Array.isArray(t))for(let n in t){const i=t[n];"object"==typeof i&&i&&x in i&&nn(i)}}(n.s);if(t){let t=0,i={};const e=B(()=>{let r=0;const e=n.s;for(const t in e)e[t]!==i[t]&&(i[t]=e[t],r=1);return r&&t++,t});r=()=>Qt(e)}var e;i.b.length&&(e=()=>{cn(n,r),a(i.b)},pt(),wt(1048584,e,1)),yt(()=>{const t=Xt(()=>i.m.map(f));return()=>{for(const n of t)"function"==typeof n&&n()}}),i.a.length&&yt(()=>{cn(n,r),a(i.a)})}();var u,h,c=Dn();(function(t={},n,i){var r;r=()=>{var r,e;return function(t,n=0){wt(8|n,t,1)}(()=>{r=e,e=[],Xt(()=>{t!==i(...e)&&(n(t,...e),r&&an(i(...r),t)&&n(null,...r))})}),()=>{var r;r=()=>{e&&an(i(...e),t)&&n(null,...e)},0===q.length&&queueMicrotask(z),q.push(r)}},wt(4,r,0)})(vt(c),t=>st(r,t),()=>Qt(r)),h=c,null!==(u=t)&&u.before(h),P()},{target:document.getElementById("app")});
